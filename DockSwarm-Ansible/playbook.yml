---
- name: Install required tools on all nodes
  hosts: all
  become: true
  roles:
    - install_tools

- name: Initialize Swarm Manager
  hosts: manager
  become: true
  roles:
    - swarm-manager

- name: Join Worker Nodes
  hosts: workers
  become: true
  roles:
    - swarm-worker

- name: Build and Deploy Application
  hosts: manager
  become: yes
  vars_files:
    - vault.yml
  roles:
    - app-build
    - app-service

